# Список вразливостей DNS Bind

Публікується з метою контролю безпеки сайтів на базі веб-серверів з DNS Bind. На замітку дослідникам та власникам електронних ресурсів. В рамках волонтерського проєкту "За вільний і безпечний UAnet!".

Дані вразливості були виявлені дослідниками KR. Laboratories в ході глобального аудиту ресурсів українського сегменту мережі Інтернет й можуть бути використані як легітимними пентестерами, так і зловмисниками для проведення різноманітних атак, зокрема: віддалене виконання коду (Remote Code Execution), несанкціонований доступ (Unauthorized Access), витоки даних (Information Disclosure), перехоплення даних "Людина посередині" (Man-in-the-Middle-Attack), відмова в обслуговуванні (Denial of Service Attack) та багато інших. Це може призвести до пошкодження або повної втрати даних на сервері, помилок конфігураці та багато іншого.  

Ми рекомендуємо українським веб-майстрам і системним адміністраторам регулярно оновлювати серверне програмне забезпечення та використовувати наші рекомендації щодо кібербезпеки, аби мінімізувати потенційні ризики.  

З приводу захисту веб-серверів пишіть нам на електронну скриньку: security[@]kr-labs.com.ua

| **CVE Ідентифікатор** &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | **Опис** | **Exploit / PoC** |
|-----------------------------------------------------|----------|-------------|
| [**CVE-2018-5743**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5743) | В BIND кількість дозволених підключень є параметром, який можна налаштувати, і якщо його не встановити, для більшості серверів за замовчуванням використовується консервативне значення. Код, призначений для обмеження кількості одночасних з’єднань, містив помилку, яку можна було використати для збільшення кількості одночасних з’єднань за межі цієї межі і проведення DoS-атаки. | N/A |
| [**CVE-2018-5744**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5744) | Помилка звільнення пам’яті може статися під час обробки повідомлень із певною комбінацією параметрів EDNS, що може привести до витоку інформації. | N/A |
| [**CVE-2018-5745**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5745) | Вразливість, яка дозволяє викликати DoS через неправильну обробку повідомлень. Проблема міститься в функції «managed-keys», яка дозволяє розв’язувачу BIND автоматично підтримувати ключі, що використовуються прив’язками довіри, які налаштовують для використання під час перевірки DNSSEC. | N/A |
| [**CVE-2018-5741**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5741) | Щоб забезпечити точне керування можливістю використання динамічного DNS (DDNS) для оновлення записів у зоні, BIND 9 надає функцію під назвою політика оновлення. Можна налаштувати різні правила, щоб обмежити типи оновлень, які може виконувати клієнт, залежно від ключа, який використовується під час надсилання запиту на оновлення. На жаль, деякі типи правил спочатку не були задокументовані, і коли документацію для них було додано до Довідкового посібника адміністратора (ARM) у зміні №3112, мова, додана до ARM на той час, неправильно описувала поведінку двох типів правил, субдомен krb5 і субдомен ms. Ця неправильна документація може змусити операторів повірити, що налаштовані ними політики є більш обмежувальними, ніж вони були насправді. Це може спричинити відмову в обслуговуванні через помилки в конфігурації. | N/A |
| [**CVE-2019-6465**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-6465) | Елементи керування для передачі зон можуть не застосовуватися належним чином до динамічно завантажуваних зон (DLZ), якщо зони доступні для запису. Проблема дозволяє віддаленому користувачу отримати конфіденційну інформацію. | N/A |
| [**CVE-2019-6470**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-6470) | В одній з бібліотек ISC BIND існувала помилка у функції, яку використовував dhcpd під час роботи в режимі DHCPv6. У dhcpd також була помилка, пов’язана з використанням цієї функції відповідно до її документації, але помилка у функції бібліотеки запобігла завданню будь-якої шкоди. Усі випуски dhcpd від ISC містять копії цієї та інших бібліотек BIND у комбінаціях, які були протестовані перед випуском і, як відомо, не викликають подібних проблем. Деякі сторонні пакувальники програмного забезпечення ISC модифікували джерело dhcpd, джерело BIND або відповідність версій таким чином, що створює потенційний збій. Згідно зі звітами, доступними ISC, ймовірність збою є великою, і не було проведено жодного аналізу того, як і навіть чи може маніпулювати ймовірністю зловмисник. | N/A |
| [**CVE-2019-6471**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-6471) | Умова режиму гонки, яка може виникнути під час відхилення неправильно сформованих пакетів, може призвести до виходу BIND через помилку твердження REQUIRE у dispatch.c. | N/A |
| [**CVE-2020-8616**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8616) | Вразливість у рекурсивному сервері DNS BIND, яка дозволяє атакуючим викликати DoS. | N/A |
| [**CVE-2020-8617**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8617) | Використовуючи спеціально створене повідомлення, зловмисник потенційно може спричинити перехід сервера BIND у неузгоджений стан, якщо зловмисник знає (або успішно вгадає) ім’я ключа TSIG, який використовується сервером. Оскільки BIND за замовчуванням налаштовує ключ локального сеансу навіть на серверах, у конфігурації яких він не використовується, майже всі поточні сервери BIND є вразливими. У випусках BIND, починаючи з березня 2018 року та пізніше, перевірка тверджень у tsig.c виявляє цей непослідовний стан і навмисно завершує роботу. До введення перевірки сервер продовжував працювати в неузгодженому стані з потенційно шкідливими результатами. | [PoC](https://github.com/knqyf263/CVE-2020-8617) |
| [**CVE-2020-8622**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8622) | Вразливість дозволяє спричинити відмову в обслуговуванні через помилку в TSIG. | N/A |
| [**CVE-2020-8623**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8623) | Зловмисник може отримати доступ до вразливої ​​системи за допомогою спеціально створеного запиту пакет та спровокувати відмову в обслуговуванні DoS. Щоб бути вразливою, система повинна: ​​*працювати під керуванням BIND, створеного за допомогою «--enable-native-pkcs11»; *підписувати одну або кілька зон за допомогою ключа RSA; *мати можливість отримувати запити від можливого зловмисника. | [PoC](https://github.com/intrigueio/cve-2020-28653-poc) |
| [**CVE-2020-8624**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8624) | Зловмисник, який отримав права змінювати певний піднабір вмісту зони DNS, може зловживати цими ненавмисними додатковими правами для оновлення іншого вмісту зони. | N/A |
| [**CVE-2020-8625**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8625) | Сервери BIND уразливі, якщо налаштовані на використання функцій GSS-TSIG. У конфігурації, яка використовує налаштування BIND за замовчуванням, шлях до вразливого коду не розкривається, але сервер можна зробити вразливим шляхом явного встановлення значень для параметрів конфігурації key-gssapi-keytab або tkey-gssapi-credential. Хоча конфігурація за замовчуванням не є вразливою, GSS-TSIG часто використовується в мережах, де BIND інтегровано з Samba, а також у змішаних серверних середовищах, які поєднують сервери BIND з контролерами домену Active Directory. Найімовірнішим результатом успішного використання вразливості є віддалене виконання коду.  | N/A |
| [**CVE-2021-25214**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-25214) | Вразливість дозволяє віддаленим атакуючим викликати DoS через некоректну обробку запитів. Порушене вхідне інкрементальне оновлення зони (IXFR) може призвести до неочікуваного завершення named. | N/A |
| [**CVE-2021-25215**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-25215) | Проблема в обробці ACL, яка дозволяє витік даних. Перевірка твердження може завершитися помилкою під час відповіді на запити для записів DNAME, які вимагають обробки DNAME для саморозв’язання | |
| [**CVE-2021-25216**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-25216) | Друга вразливість в узгодженні політики безпеки GSSAPI BIND може стати передумовою атаки переповнення буфера й викликати DoS. | N/A |
| [**CVE-2021-25219**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-25219) | Вразливість дозволяє атакуючим викликати відмову в обслуговуванні через некоректну обробку запитів в lame cache. | N/A |
| [**CVE-2022-2795**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2795) | Проблема з обробкою повідомлень DNS, яка дозволяє викликати DoS. | N/A |
| [**CVE-2022-3488**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3488) | Уразливість дозволяє виконати DoS через помилки у відповіді сервера. | N/A |
| [**CVE-2022-38177**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-38177) | Підмінюючи цільовий резолвер відповідями, які мають неправильний підпис ECDSA, зловмисник може викликати невеликий витік пам’яті. Доступну пам’ять можна поступово вичерпати до точки, коли named виходить з ладу через брак ресурсів. | N/A |
| [**CVE-2022-38178**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-38178) | Аналогічна вразливість у DNS ECDSA, яка дозволяє виконати відмову в обслуговуванні. | N/A |
| [**CVE-2023-2828**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-2828) | Кожен `named` екземпляр, налаштований для роботи як рекурсивний розпізнавач, підтримує кеш-базу даних, що містить відповіді на запити, які він нещодавно надіслав на авторитетні сервери. Обмеження розміру цієї бази даних кешу можна налаштувати за допомогою оператора `max-cache-size` у файлі конфігурації; за замовчуванням він займає 90% від загального обсягу пам’яті, доступної на хості. Коли розмір кешу досягає 7/8 налаштованого ліміту, алгоритм очищення кешу починає видаляти з кешу прострочені та/або найменш використовувані RRsets, щоб використання пам’яті було нижче налаштованого ліміту. Було виявлено, що ефективність алгоритму очищення кешу, який використовується в `named`, може бути суттєво знижена шляхом запиту до розпізнавача певних наборів RR у певному порядку, фактично дозволяючи значно перевищити налаштований ліміт `max-cache-size` . | N/A |
| [**CVE-2023-3341**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3341) | Код, який обробляє повідомлення каналу керування, надіслані до `named`, рекурсивно викликає певні функції під час розбору пакетів. Глибина рекурсії обмежена лише максимальним прийнятним розміром пакета; залежно від середовища це може призвести до того, що код розбору пакетів вичерпає доступну пам’ять стека, що призведе до неочікуваного завершення роботи `named`. Оскільки кожне вхідне повідомлення каналу керування повністю аналізується перед автентифікацією його вмісту, використання цієї вади не вимагає від зловмисника мати дійсний ключ RNDC; необхідний лише мережевий доступ до налаштованого TCP-порту каналу керування. | N/A |
| [**CVE-2023-50387**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-50387) | Певні аспекти DNSSEC протоколу DNS (у RFC 4033, 4034, 4035, 6840 та пов’язаних RFC) дозволяють віддаленим зловмисникам викликати відмову в обслуговуванні (споживання ЦП) за допомогою однієї чи кількох відповідей DNSSEC, також відомої як проблема «KeyTrap». Одна з проблем полягає в тому, що коли існує зона з багатьма записами DNSKEY і RRSIG, специфікація протоколу передбачає, що алгоритм повинен оцінювати всі комбінації записів DNSKEY і RRSIG. | [PoC](https://github.com/knqyf263/CVE-2023-50387) [Деталі](https://blog.cloudflare.com/remediating-new-dnssec-resource-exhaustion-vulnerabilities/) |

## Джерела
- [“KeyTrap” (CVE-2023-50387) Flaw Leaves DNS Systems Vulnerable, PoC Published](https://securityonline.info/keytrap-cve-2023-50387-flaw-leaves-dns-systems-vulnerable-poc-published/)
